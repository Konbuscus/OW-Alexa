'use strict';

const webhook = require('../index').Webhook;
const io = require('socket.io-client');
const socket = io.connect('https://0ca9af30.ngrok.io', {reconnect: true});


webhook.listen(3001, function() {
    console.log('Example server listening on port 3001!');
});

socket.on('connect', function(socket) {
    console.log('Connected!');
});



const app = require('../index').Jovo;
app.enableRequestLogging();
app.enableResponseLogging();

// listen for post requests
webhook.post('/webhook', function(req, res) {
    app.handleRequest(req, res, handlers);
    app.execute();
});


let handlers = {
    'LAUNCH': function() {
        // app.ask('What?', 'What?!');
        app.toIntent('NoHandsIntent');
        // app.tell('Toyota & Mazda to build a new 1.6B plant here in the U.S.A. and create 4K new American jobs. A great investment in American manufacturing!');
    },
    'NoHandsIntent': function() {
        let sb = app.speechBuilder();
        sb.addText('abc');
        sb.addText('def');

        app.tell(sb);
        // let from = 'skillid';
        //
        // socket.emit('toserver', 'skill', 'read');
        //
        // socket.on('toskill', function(msg) {
        //     app.tell(msg);
        // });
    },
};
